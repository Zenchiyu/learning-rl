<!DOCTYPE html>
<!-- saved from url=(0033)http://pierrelucbacon.com/traces/ -->
<html lang="en"><link type="text/css" rel="stylesheet" id="dark-mode-custom-link"><link type="text/css" rel="stylesheet" id="dark-mode-general-link"><style lang="en" type="text/css" id="dark-mode-custom-style"></style><style lang="en" type="text/css" id="dark-mode-native-style"></style><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

        <title>Understanding eligibility traces in Reinforcement Learning</title>
         <link href="./Understanding eligibility traces in Reinforcement Learning_files/css" rel="stylesheet">
     <link href="./Understanding eligibility traces in Reinforcement Learning_files/bootstrap.min.css" rel="stylesheet">
    <link href="./Understanding eligibility traces in Reinforcement Learning_files/custom.css" rel="stylesheet">

        <script async="" src="./Understanding eligibility traces in Reinforcement Learning_files/analytics.js.téléchargé"></script><script src="./Understanding eligibility traces in Reinforcement Learning_files/MathJax.js.téléchargé" id=""></script>
      <style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.mjx-chtml {display: inline-block; line-height: 0; text-indent: 0; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; letter-spacing: normal; word-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; margin: 0; padding: 1px 0}
.MJXc-display {display: block; text-align: center; margin: 1em 0; padding: 0}
.mjx-chtml[tabindex]:focus, body :focus .mjx-chtml[tabindex] {display: inline-table}
.mjx-full-width {text-align: center; display: table-cell!important; width: 10000em}
.mjx-math {display: inline-block; border-collapse: separate; border-spacing: 0}
.mjx-math * {display: inline-block; -webkit-box-sizing: content-box!important; -moz-box-sizing: content-box!important; box-sizing: content-box!important; text-align: left}
.mjx-numerator {display: block; text-align: center}
.mjx-denominator {display: block; text-align: center}
.MJXc-stacked {height: 0; position: relative}
.MJXc-stacked > * {position: absolute}
.MJXc-bevelled > * {display: inline-block}
.mjx-stack {display: inline-block}
.mjx-op {display: block}
.mjx-under {display: table-cell}
.mjx-over {display: block}
.mjx-over > * {padding-left: 0px!important; padding-right: 0px!important}
.mjx-under > * {padding-left: 0px!important; padding-right: 0px!important}
.mjx-stack > .mjx-sup {display: block}
.mjx-stack > .mjx-sub {display: block}
.mjx-prestack > .mjx-presup {display: block}
.mjx-prestack > .mjx-presub {display: block}
.mjx-delim-h > .mjx-char {display: inline-block}
.mjx-surd {vertical-align: top}
.mjx-mphantom * {visibility: hidden}
.mjx-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 2px 3px; font-style: normal; font-size: 90%}
.mjx-annotation-xml {line-height: normal}
.mjx-menclose > svg {fill: none; stroke: currentColor}
.mjx-mtr {display: table-row}
.mjx-mlabeledtr {display: table-row}
.mjx-mtd {display: table-cell; text-align: center}
.mjx-label {display: table-row}
.mjx-box {display: inline-block}
.mjx-block {display: block}
.mjx-span {display: inline}
.mjx-char {display: block; white-space: pre}
.mjx-itable {display: inline-table; width: auto}
.mjx-row {display: table-row}
.mjx-cell {display: table-cell}
.mjx-table {display: table; width: 100%}
.mjx-line {display: block; height: 0}
.mjx-strut {width: 0; padding-top: 1em}
.mjx-vsize {width: 0}
.MJXc-space1 {margin-left: .167em}
.MJXc-space2 {margin-left: .222em}
.MJXc-space3 {margin-left: .278em}
.mjx-chartest {display: block; visibility: hidden; position: absolute; top: 0; line-height: normal; font-size: 500%}
.mjx-chartest .mjx-char {display: inline}
.mjx-chartest .mjx-box {padding-top: 1000px}
.MJXc-processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MJXc-processed {display: none}
.mjx-test {display: block; font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow: hidden; height: 1px}
.mjx-ex-box-test {position: absolute; width: 1px; height: 60ex}
.mjx-line-box-test {display: table!important}
.mjx-line-box-test span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
#MathJax_CHTML_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.mjx-chtml .mjx-noError {line-height: 1.2; vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
.MJXc-TeX-unknown-R {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: normal; font-weight: normal}
.MJXc-TeX-unknown-I {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: italic; font-weight: normal}
.MJXc-TeX-unknown-B {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: normal; font-weight: bold}
.MJXc-TeX-unknown-BI {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: italic; font-weight: bold}
.MJXc-TeX-ams-R {font-family: MJXc-TeX-ams-R,MJXc-TeX-ams-Rw}
.MJXc-TeX-cal-B {font-family: MJXc-TeX-cal-B,MJXc-TeX-cal-Bx,MJXc-TeX-cal-Bw}
.MJXc-TeX-frak-R {font-family: MJXc-TeX-frak-R,MJXc-TeX-frak-Rw}
.MJXc-TeX-frak-B {font-family: MJXc-TeX-frak-B,MJXc-TeX-frak-Bx,MJXc-TeX-frak-Bw}
.MJXc-TeX-math-BI {font-family: MJXc-TeX-math-BI,MJXc-TeX-math-BIx,MJXc-TeX-math-BIw}
.MJXc-TeX-sans-R {font-family: MJXc-TeX-sans-R,MJXc-TeX-sans-Rw}
.MJXc-TeX-sans-B {font-family: MJXc-TeX-sans-B,MJXc-TeX-sans-Bx,MJXc-TeX-sans-Bw}
.MJXc-TeX-sans-I {font-family: MJXc-TeX-sans-I,MJXc-TeX-sans-Ix,MJXc-TeX-sans-Iw}
.MJXc-TeX-script-R {font-family: MJXc-TeX-script-R,MJXc-TeX-script-Rw}
.MJXc-TeX-type-R {font-family: MJXc-TeX-type-R,MJXc-TeX-type-Rw}
.MJXc-TeX-cal-R {font-family: MJXc-TeX-cal-R,MJXc-TeX-cal-Rw}
.MJXc-TeX-main-B {font-family: MJXc-TeX-main-B,MJXc-TeX-main-Bx,MJXc-TeX-main-Bw}
.MJXc-TeX-main-I {font-family: MJXc-TeX-main-I,MJXc-TeX-main-Ix,MJXc-TeX-main-Iw}
.MJXc-TeX-main-R {font-family: MJXc-TeX-main-R,MJXc-TeX-main-Rw}
.MJXc-TeX-math-I {font-family: MJXc-TeX-math-I,MJXc-TeX-math-Ix,MJXc-TeX-math-Iw}
.MJXc-TeX-size1-R {font-family: MJXc-TeX-size1-R,MJXc-TeX-size1-Rw}
.MJXc-TeX-size2-R {font-family: MJXc-TeX-size2-R,MJXc-TeX-size2-Rw}
.MJXc-TeX-size3-R {font-family: MJXc-TeX-size3-R,MJXc-TeX-size3-Rw}
.MJXc-TeX-size4-R {font-family: MJXc-TeX-size4-R,MJXc-TeX-size4-Rw}
@font-face {font-family: MJXc-TeX-ams-R; src: local('MathJax_AMS'), local('MathJax_AMS-Regular')}
@font-face {font-family: MJXc-TeX-ams-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_AMS-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-cal-B; src: local('MathJax_Caligraphic Bold'), local('MathJax_Caligraphic-Bold')}
@font-face {font-family: MJXc-TeX-cal-Bx; src: local('MathJax_Caligraphic'); font-weight: bold}
@font-face {font-family: MJXc-TeX-cal-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Caligraphic-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-frak-R; src: local('MathJax_Fraktur'), local('MathJax_Fraktur-Regular')}
@font-face {font-family: MJXc-TeX-frak-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Fraktur-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Fraktur-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-frak-B; src: local('MathJax_Fraktur Bold'), local('MathJax_Fraktur-Bold')}
@font-face {font-family: MJXc-TeX-frak-Bx; src: local('MathJax_Fraktur'); font-weight: bold}
@font-face {font-family: MJXc-TeX-frak-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Fraktur-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Fraktur-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-math-BI; src: local('MathJax_Math BoldItalic'), local('MathJax_Math-BoldItalic')}
@font-face {font-family: MJXc-TeX-math-BIx; src: local('MathJax_Math'); font-weight: bold; font-style: italic}
@font-face {font-family: MJXc-TeX-math-BIw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Math-BoldItalic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-BoldItalic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-BoldItalic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-R; src: local('MathJax_SansSerif'), local('MathJax_SansSerif-Regular')}
@font-face {font-family: MJXc-TeX-sans-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-B; src: local('MathJax_SansSerif Bold'), local('MathJax_SansSerif-Bold')}
@font-face {font-family: MJXc-TeX-sans-Bx; src: local('MathJax_SansSerif'); font-weight: bold}
@font-face {font-family: MJXc-TeX-sans-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-I; src: local('MathJax_SansSerif Italic'), local('MathJax_SansSerif-Italic')}
@font-face {font-family: MJXc-TeX-sans-Ix; src: local('MathJax_SansSerif'); font-style: italic}
@font-face {font-family: MJXc-TeX-sans-Iw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Italic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Italic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-script-R; src: local('MathJax_Script'), local('MathJax_Script-Regular')}
@font-face {font-family: MJXc-TeX-script-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Script-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Script-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Script-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-type-R; src: local('MathJax_Typewriter'), local('MathJax_Typewriter-Regular')}
@font-face {font-family: MJXc-TeX-type-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Typewriter-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Typewriter-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Typewriter-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-cal-R; src: local('MathJax_Caligraphic'), local('MathJax_Caligraphic-Regular')}
@font-face {font-family: MJXc-TeX-cal-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Caligraphic-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-B; src: local('MathJax_Main Bold'), local('MathJax_Main-Bold')}
@font-face {font-family: MJXc-TeX-main-Bx; src: local('MathJax_Main'); font-weight: bold}
@font-face {font-family: MJXc-TeX-main-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Main-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-I; src: local('MathJax_Main Italic'), local('MathJax_Main-Italic')}
@font-face {font-family: MJXc-TeX-main-Ix; src: local('MathJax_Main'); font-style: italic}
@font-face {font-family: MJXc-TeX-main-Iw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Main-Italic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-R; src: local('MathJax_Main'), local('MathJax_Main-Regular')}
@font-face {font-family: MJXc-TeX-main-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Main-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-math-I; src: local('MathJax_Math Italic'), local('MathJax_Math-Italic')}
@font-face {font-family: MJXc-TeX-math-Ix; src: local('MathJax_Math'); font-style: italic}
@font-face {font-family: MJXc-TeX-math-Iw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Math-Italic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size1-R; src: local('MathJax_Size1'), local('MathJax_Size1-Regular')}
@font-face {font-family: MJXc-TeX-size1-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Size1-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size2-R; src: local('MathJax_Size2'), local('MathJax_Size2-Regular')}
@font-face {font-family: MJXc-TeX-size2-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Size2-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size3-R; src: local('MathJax_Size3'), local('MathJax_Size3-Regular')}
@font-face {font-family: MJXc-TeX-size3-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Size3-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size4-R; src: local('MathJax_Size4'), local('MathJax_Size4-Regular')}
@font-face {font-family: MJXc-TeX-size4-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Size4-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf') format('opentype')}
</style></head>

  <body><div id="MathJax_Message" style="display: none;"></div>
    <nav class="navbar navbar-default navbar-custom">
        <div class="container-fluid">
            <div class="navbar-header">
                <a class="page-scroll navbar-brand" href="http://pierrelucbacon.com/">Pierre-Luc Bacon</a>
            </div>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a class="page-scroll" href="http://pierrelucbacon.com/teaching">Teaching</a>
                </li>
                <li>
                    <a class="page-scroll" href="http://pierrelucbacon.com/group">Group</a>
                </li>
                <li>
                    <a class="page-scroll" href="http://pierrelucbacon.com/contact">Contact</a>
                </li>
            </ul>
        </div>
    </nav>
    <div class="container container-article">
    <div class="page-header">
                <h1>Understanding eligibility traces in Reinforcement Learning</h1>
                <p class="date">October 1st 2015, Pierre-Luc Bacon</p>
    </div>
    <p>Eligibility traces in reinforcement: I don't understand them. Sure, the implementation of the <a href="https://webdocs.cs.ualberta.ca/~sutton/book/ebook/node75.html">backward view</a> (the <em>memory meachnism</em>) does appeal to my intuition but its relation to the <a href="https://webdocs.cs.ualberta.ca/~sutton/book/ebook/node74.html">forward view</a> needs a more careful treatment.</p>
    <p>Here are some notes in preparation for our <a href="http://rl.cs.mcgill.ca/tracesgroup/">reading group on eligibility traces in RL</a>.</p>
    <h2 id="notation">Notation</h2>
    <p>Reinforcement learning laid its foundations upon the framework of Markov Decision Processes (MDP). An MDP is a tuple <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-1-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;A&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-1" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2" class="mjx-mrow"><span id="MJXc-Node-3" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">⟨</span></span><span id="MJXc-Node-4" class="mjx-texatom"><span id="MJXc-Node-5" class="mjx-mrow"><span id="MJXc-Node-6" class="mjx-mi"><span class="mjx-char MJXc-TeX-cal-R" style="padding-top: 0.423em; padding-bottom: 0.329em; padding-right: 0.036em;">S</span></span></span></span><span id="MJXc-Node-7" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.184em; padding-bottom: 0.516em;">,</span></span><span id="MJXc-Node-8" class="mjx-texatom MJXc-space1"><span id="MJXc-Node-9" class="mjx-mrow"><span id="MJXc-Node-10" class="mjx-mi"><span class="mjx-char MJXc-TeX-cal-R" style="padding-top: 0.469em; padding-bottom: 0.376em; padding-right: 0.021em;">A</span></span></span></span><span id="MJXc-Node-11" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.184em; padding-bottom: 0.516em;">,</span></span><span id="MJXc-Node-12" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-13" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-14" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.002em; padding-bottom: 0.329em;">⋅</span></span><span id="MJXc-Node-15" class="mjx-mspace" style="width: 0.167em; height: 0px;"></span><span id="MJXc-Node-16" class="mjx-texatom"><span id="MJXc-Node-17" class="mjx-mrow"><span id="MJXc-Node-18" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">|</span></span></span></span><span id="MJXc-Node-19" class="mjx-mspace" style="width: 0.167em; height: 0px;"></span><span id="MJXc-Node-20" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-21" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.184em; padding-bottom: 0.516em;">,</span></span><span id="MJXc-Node-22" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">a</span></span><span id="MJXc-Node-23" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span id="MJXc-Node-24" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.184em; padding-bottom: 0.516em;">,</span></span><span id="MJXc-Node-25" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">⟩</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">⟨</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">S</mi></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">A</mi></mrow><mo>,</mo><mi>P</mi><mo stretchy="false">(</mo><mo>⋅</mo><mspace width="thinmathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mspace width="thinmathspace"></mspace><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>,</mo><mo fence="false" stretchy="false">⟩</mo></math></span></span><script type="math/tex" id="MathJax-Element-1">\langle \mathcal{S}, \mathcal{A}, P(\cdot \,|\, s, a), \rangle</script></span> consisting of set of states <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-2-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-26" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-27" class="mjx-mrow"><span id="MJXc-Node-28" class="mjx-texatom"><span id="MJXc-Node-29" class="mjx-mrow"><span id="MJXc-Node-30" class="mjx-mi"><span class="mjx-char MJXc-TeX-cal-R" style="padding-top: 0.423em; padding-bottom: 0.329em; padding-right: 0.036em;">S</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">S</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-2">\mathcal{S}</script></span>, a set of actions <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-3-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;A&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-31" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-32" class="mjx-mrow"><span id="MJXc-Node-33" class="mjx-texatom"><span id="MJXc-Node-34" class="mjx-mrow"><span id="MJXc-Node-35" class="mjx-mi"><span class="mjx-char MJXc-TeX-cal-R" style="padding-top: 0.469em; padding-bottom: 0.376em; padding-right: 0.021em;">A</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">A</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-3">\mathcal{A}</script></span>, a transition matrix (or kernel) <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-4-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-36" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-37" class="mjx-mrow"><span id="MJXc-Node-38" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-39" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-40" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.002em; padding-bottom: 0.329em;">⋅</span></span><span id="MJXc-Node-41" class="mjx-mspace" style="width: 0.167em; height: 0px;"></span><span id="MJXc-Node-42" class="mjx-texatom"><span id="MJXc-Node-43" class="mjx-mrow"><span id="MJXc-Node-44" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">|</span></span></span></span><span id="MJXc-Node-45" class="mjx-mspace" style="width: 0.167em; height: 0px;"></span><span id="MJXc-Node-46" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-47" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.184em; padding-bottom: 0.516em;">,</span></span><span id="MJXc-Node-48" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">a</span></span><span id="MJXc-Node-49" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mo>⋅</mo><mspace width="thinmathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mspace width="thinmathspace"></mspace><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-4">P(\cdot \,|\, s, a)</script></span> and a reward function <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-5-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;A&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-50" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-51" class="mjx-mrow"><span id="MJXc-Node-52" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">r</span></span><span id="MJXc-Node-53" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.142em; padding-bottom: 0.329em;">:</span></span><span id="MJXc-Node-54" class="mjx-texatom MJXc-space3"><span id="MJXc-Node-55" class="mjx-mrow"><span id="MJXc-Node-56" class="mjx-mi"><span class="mjx-char MJXc-TeX-cal-R" style="padding-top: 0.423em; padding-bottom: 0.329em; padding-right: 0.036em;">S</span></span></span></span><span id="MJXc-Node-57" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.189em; padding-bottom: 0.329em;">×</span></span><span id="MJXc-Node-58" class="mjx-texatom MJXc-space2"><span id="MJXc-Node-59" class="mjx-mrow"><span id="MJXc-Node-60" class="mjx-mi"><span class="mjx-char MJXc-TeX-cal-R" style="padding-top: 0.469em; padding-bottom: 0.376em; padding-right: 0.021em;">A</span></span></span></span><span id="MJXc-Node-61" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.236em; padding-bottom: 0.329em;">→</span></span><span id="MJXc-Node-62" class="mjx-texatom MJXc-space3"><span id="MJXc-Node-63" class="mjx-mrow"><span id="MJXc-Node-64" class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.423em; padding-bottom: 0.282em;">R</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo>:</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">S</mi></mrow><mo>×</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">A</mi></mrow><mo stretchy="false">→</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">R</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-5">r : \mathcal{S} \times \mathcal{A} \to \mathbb{R}</script></span>.</p>
    <p>For simplicity, we will restrict our attention to the infinite discounted return, defined as:</p>
    <p><span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-6-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x221E;&lt;/mi&gt;&lt;/munderover&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;}&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-65" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-66" class="mjx-mrow"><span id="MJXc-Node-67" class="mjx-texatom"><span id="MJXc-Node-68" class="mjx-mrow"><span id="MJXc-Node-69" class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.423em; padding-bottom: 0.282em;">E</span></span></span></span><span id="MJXc-Node-70" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-71" class="mjx-mo"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 1.543em; padding-bottom: 1.543em;">{</span></span><span id="MJXc-Node-72" class="mjx-mrow"><span id="MJXc-Node-73" class="mjx-munderover"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.247em; padding-top: 0.141em; padding-left: 0.521em;"><span id="MJXc-Node-80" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.142em; padding-bottom: 0.329em;">∞</span></span></span><span class="mjx-op"><span id="MJXc-Node-74" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.749em; padding-bottom: 0.749em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.202em;"><span id="MJXc-Node-75" class="mjx-texatom" style=""><span id="MJXc-Node-76" class="mjx-mrow"><span id="MJXc-Node-77" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.282em;">t</span></span><span id="MJXc-Node-78" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.096em; padding-bottom: 0.329em;">=</span></span><span id="MJXc-Node-79" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.376em; padding-bottom: 0.329em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-81" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.025em;"><span id="MJXc-Node-82" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.516em; padding-right: 0.025em;">γ</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.117em; padding-right: 0.071em;"><span id="MJXc-Node-83" class="mjx-texatom" style=""><span id="MJXc-Node-84" class="mjx-mrow"><span id="MJXc-Node-85" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.282em;">t</span></span><span id="MJXc-Node-86" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.423em;">−</span></span><span id="MJXc-Node-87" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.376em; padding-bottom: 0.329em;">1</span></span></span></span></span></span><span id="MJXc-Node-88" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-89" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">r</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-90" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.282em;">t</span></span></span></span><span id="MJXc-Node-91" class="mjx-mspace" style="width: 0.167em; height: 0px;"></span><span id="MJXc-Node-92" class="mjx-texatom"><span id="MJXc-Node-93" class="mjx-mrow"><span id="MJXc-Node-94" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">|</span></span></span></span><span id="MJXc-Node-95" class="mjx-mspace" style="width: 0.167em; height: 0px;"></span><span id="MJXc-Node-96" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-97" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-98" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.376em; padding-bottom: 0.376em;">0</span></span></span></span><span id="MJXc-Node-99" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.096em; padding-bottom: 0.329em;">=</span></span><span id="MJXc-Node-100" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-101" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.184em; padding-bottom: 0.516em;">,</span></span><span id="MJXc-Node-102" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span><span id="MJXc-Node-103" class="mjx-mo"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 1.543em; padding-bottom: 1.543em;">}</span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow><mo>{</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi mathvariant="normal">∞</mi></munderover><msup><mi>γ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup><msub><mi>r</mi><mi>t</mi></msub><mspace width="thinmathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mspace width="thinmathspace"></mspace><msub><mi>s</mi><mn>0</mn></msub><mo>=</mo><mi>s</mi><mo>,</mo><mi>π</mi></mrow><mo>}</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-6">
    \begin{equation}
    \mathbb{E}\left\{ \sum_{t=1}^\infty \gamma^{t-1} r_t \,|\, s_0=s, \pi \right\}
    \end{equation}
    </script></span></p>
    <p>where <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-7-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-104" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-105" class="mjx-mrow"><span id="MJXc-Node-106" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.376em; padding-bottom: 0.376em;">0</span></span><span id="MJXc-Node-107" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.329em; padding-bottom: 0.469em;">≥</span></span><span id="MJXc-Node-108" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.516em; padding-right: 0.025em;">γ</span></span><span id="MJXc-Node-109" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.236em; padding-bottom: 0.376em;">&lt;</span></span><span id="MJXc-Node-110" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.376em; padding-bottom: 0.329em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn><mo>≥</mo><mi>γ</mi><mo>&lt;</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-7">0 \geq \gamma < 1</script></span> is a <em>discount factor</em> and <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-8-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-111" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-112" class="mjx-mrow"><span id="MJXc-Node-113" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">\pi</script></span> is a <em>policy</em> (stochastic or deterministic).</p>
    <h2 id="policy-evaluation">Policy Evaluation</h2>
    <p>The Bellman equations are defined as:</p>
    <p><span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-9-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-114" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-115" class="mjx-mrow"><span id="MJXc-Node-116" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-117" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.186em;">V</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-118" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span></span><span id="MJXc-Node-119" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-120" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-121" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span id="MJXc-Node-122" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.096em; padding-bottom: 0.329em;">=</span></span><span id="MJXc-Node-123" class="mjx-munderover MJXc-space3"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-124" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.749em; padding-bottom: 0.749em;">∑</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.757em;"><span id="MJXc-Node-125" class="mjx-texatom" style=""><span id="MJXc-Node-126" class="mjx-mrow"><span id="MJXc-Node-127" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">a</span></span></span></span></span></span></span></span><span id="MJXc-Node-128" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span><span id="MJXc-Node-129" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-130" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">a</span></span><span id="MJXc-Node-131" class="mjx-mspace" style="width: 0.167em; height: 0px;"></span><span id="MJXc-Node-132" class="mjx-texatom"><span id="MJXc-Node-133" class="mjx-mrow"><span id="MJXc-Node-134" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">|</span></span></span></span><span id="MJXc-Node-135" class="mjx-mspace" style="width: 0.167em; height: 0px;"></span><span id="MJXc-Node-136" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-137" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span id="MJXc-Node-138" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-139" class="mjx-mo"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 1.543em; padding-bottom: 1.543em;">(</span></span><span id="MJXc-Node-140" class="mjx-mrow"><span id="MJXc-Node-141" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">r</span></span><span id="MJXc-Node-142" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-143" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-144" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.184em; padding-bottom: 0.516em;">,</span></span><span id="MJXc-Node-145" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">a</span></span><span id="MJXc-Node-146" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span id="MJXc-Node-147" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.423em;">+</span></span><span id="MJXc-Node-148" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.516em; padding-right: 0.025em;">γ</span></span><span id="MJXc-Node-149" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-150" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.749em; padding-bottom: 0.749em;">∑</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.672em;"><span id="MJXc-Node-151" class="mjx-texatom" style=""><span id="MJXc-Node-152" class="mjx-mrow"><span id="MJXc-Node-153" class="mjx-msup"><span class="mjx-base"><span id="MJXc-Node-154" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-155" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.329em;">′</span></span></span></span></span></span></span></span></span></span><span id="MJXc-Node-156" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-157" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-158" class="mjx-msup"><span class="mjx-base"><span id="MJXc-Node-159" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-160" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.329em;">′</span></span></span></span><span id="MJXc-Node-161" class="mjx-mspace" style="width: 0.167em; height: 0px;"></span><span id="MJXc-Node-162" class="mjx-texatom"><span id="MJXc-Node-163" class="mjx-mrow"><span id="MJXc-Node-164" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">|</span></span></span></span><span id="MJXc-Node-165" class="mjx-mspace" style="width: 0.167em; height: 0px;"></span><span id="MJXc-Node-166" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-167" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.184em; padding-bottom: 0.516em;">,</span></span><span id="MJXc-Node-168" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">a</span></span><span id="MJXc-Node-169" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span id="MJXc-Node-170" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.186em;">V</span></span><span id="MJXc-Node-171" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-172" class="mjx-msup"><span class="mjx-base"><span id="MJXc-Node-173" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-174" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.329em;">′</span></span></span></span><span id="MJXc-Node-175" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span></span><span id="MJXc-Node-176" class="mjx-mo"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 1.543em; padding-bottom: 1.543em;">)</span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>V</mi><mi>π</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></munder><mi>π</mi><mo stretchy="false">(</mo><mi>a</mi><mspace width="thinmathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mspace width="thinmathspace"></mspace><mi>s</mi><mo stretchy="false">)</mo><mrow><mo>(</mo><mrow><mi>r</mi><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>+</mo><mi>γ</mi><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>s</mi><mo>′</mo></msup></mrow></munder><mi>P</mi><mo stretchy="false">(</mo><msup><mi>s</mi><mo>′</mo></msup><mspace width="thinmathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mspace width="thinmathspace"></mspace><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo><mi>V</mi><mo stretchy="false">(</mo><msup><mi>s</mi><mo>′</mo></msup><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-9">
    \begin{equation}
    V_\pi(s) = \sum_{a} \pi(a \,|\, s) \left( r(s,a) + \gamma \sum_{s'} P(s' \,|\, s, a) V(s') \right)
    \end{equation}
    </script></span></p>
    <p>The problem of solving the Bellman equations is often called the <em>policy evaluation problem</em>. Gaussian elimination or value iteration are possible solutions when the MDP is known. In reinforcement learning, this problem is often called the <em>prediction problem</em> and is often solved using <em>temporal difference learning</em>.</p>
    <h2 id="optimal-control">Optimal control</h2>
    <p>The optimal control problem is associated with Bellman's famous <em>principle of optimality</em> and can be expressed via the the so-called <em>Bellman optimality equations</em>:</p>
    <p><span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-10-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/munder&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-177" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-178" class="mjx-mrow"><span id="MJXc-Node-179" class="mjx-mtable" style="vertical-align: -0.895em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-180" class="mjx-mtr" style="height: 2.291em;"><span id="MJXc-Node-181" class="mjx-mtd" style="padding: 0px; text-align: right; width: 2.511em;"><span id="MJXc-Node-182" class="mjx-mrow" style="margin-top: -0.025em;"><span id="MJXc-Node-183" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-184" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.186em;">V</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.413em; padding-right: 0.071em;"><span id="MJXc-Node-185" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.189em; padding-bottom: 0.329em;">∗</span></span></span></span><span id="MJXc-Node-186" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-187" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-188" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-189" class="mjx-mtd" style="padding: 0px; text-align: left; width: 16.154em;"><span id="MJXc-Node-190" class="mjx-mrow" style="margin-top: -0.025em;"><span id="MJXc-Node-191" class="mjx-mi"></span><span id="MJXc-Node-192" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.096em; padding-bottom: 0.329em;">=</span></span><span id="MJXc-Node-193" class="mjx-munderover MJXc-space3"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-194" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.142em; padding-bottom: 0.329em;">max</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 1.051em;"><span id="MJXc-Node-195" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">a</span></span></span></span></span></span><span id="MJXc-Node-196" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">r</span></span><span id="MJXc-Node-197" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-198" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-199" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.184em; padding-bottom: 0.516em;">,</span></span><span id="MJXc-Node-200" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">a</span></span><span id="MJXc-Node-201" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span id="MJXc-Node-202" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.423em;">+</span></span><span id="MJXc-Node-203" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.516em; padding-right: 0.025em;">γ</span></span><span id="MJXc-Node-204" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-205" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.749em; padding-bottom: 0.749em;">∑</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.672em;"><span id="MJXc-Node-206" class="mjx-texatom" style=""><span id="MJXc-Node-207" class="mjx-mrow"><span id="MJXc-Node-208" class="mjx-msup"><span class="mjx-base"><span id="MJXc-Node-209" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-210" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.329em;">′</span></span></span></span></span></span></span></span></span></span><span id="MJXc-Node-211" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-212" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-213" class="mjx-msup"><span class="mjx-base"><span id="MJXc-Node-214" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-215" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.329em;">′</span></span></span></span><span id="MJXc-Node-216" class="mjx-mspace" style="width: 0.167em; height: 0px;"></span><span id="MJXc-Node-217" class="mjx-texatom"><span id="MJXc-Node-218" class="mjx-mrow"><span id="MJXc-Node-219" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">|</span></span></span></span><span id="MJXc-Node-220" class="mjx-mspace" style="width: 0.167em; height: 0px;"></span><span id="MJXc-Node-221" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-222" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.184em; padding-bottom: 0.516em;">,</span></span><span id="MJXc-Node-223" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">a</span></span><span id="MJXc-Node-224" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span id="MJXc-Node-225" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-226" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.186em;">V</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.413em; padding-right: 0.071em;"><span id="MJXc-Node-227" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.189em; padding-bottom: 0.329em;">∗</span></span></span></span><span id="MJXc-Node-228" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-229" class="mjx-msup"><span class="mjx-base"><span id="MJXc-Node-230" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-231" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.329em;">′</span></span></span></span><span id="MJXc-Node-232" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msup><mi>V</mi><mo>∗</mo></msup><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><munder><mo movablelimits="true" form="prefix">max</mo><mi>a</mi></munder><mi>r</mi><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>+</mo><mi>γ</mi><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>s</mi><mo>′</mo></msup></mrow></munder><mi>P</mi><mo stretchy="false">(</mo><msup><mi>s</mi><mo>′</mo></msup><mspace width="thinmathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mspace width="thinmathspace"></mspace><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo><msup><mi>V</mi><mo>∗</mo></msup><mo stretchy="false">(</mo><msup><mi>s</mi><mo>′</mo></msup><mo stretchy="false">)</mo></mtd></mtr></mtable></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-10">
     \begin{align*}
     V^*(s) &= \max_a r(s,a) + \gamma \sum_{s'}P(s' \,|\, s, a) V^*(s')
     \end{align*}
     </script></span></p>
    <p>A policy is optimal (denoted by a star) if it's underlying value function is optimal. If the MDP is known, value iteration and policy iteration can be used to compute an optimal stationary policy. Note that the stationarity of the policy is due to the infinite discounted return criterion ; this wouldn't be the case for finite horizons.</p>
    <h2 id="bellman-operator">Bellman operator</h2>
    <p>It is sometimes useful to adopt the operator point of view of the set of of Bellman equations and write:</p>
    <p><span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-11-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;P&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-233" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-234" class="mjx-mrow"><span id="MJXc-Node-235" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.12em;">T</span></span><span id="MJXc-Node-236" class="mjx-texatom"><span id="MJXc-Node-237" class="mjx-mrow"><span id="MJXc-Node-238" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.142em; padding-bottom: 0.376em;">v</span></span></span></span><span id="MJXc-Node-239" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.096em; padding-bottom: 0.329em;">=</span></span><span id="MJXc-Node-240" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-241" class="mjx-texatom"><span id="MJXc-Node-242" class="mjx-mrow"><span id="MJXc-Node-243" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.142em; padding-bottom: 0.376em;">r</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-244" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span></span><span id="MJXc-Node-245" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.423em;">+</span></span><span id="MJXc-Node-246" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.516em; padding-right: 0.025em;">γ</span></span><span id="MJXc-Node-247" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-248" class="mjx-texatom"><span id="MJXc-Node-249" class="mjx-mrow"><span id="MJXc-Node-250" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.376em; padding-bottom: 0.376em;">P</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-251" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span></span><span id="MJXc-Node-252" class="mjx-texatom"><span id="MJXc-Node-253" class="mjx-mrow"><span id="MJXc-Node-254" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.142em; padding-bottom: 0.376em;">v</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo>=</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">r</mi></mrow><mi>π</mi></msub><mo>+</mo><mi>γ</mi><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">P</mi></mrow><mi>π</mi></msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-11">
    \begin{equation}
    T \mathbf{v} = \mathbf{r}_\pi + \gamma \mathbf{P}_\pi \mathbf{v}
    \end{equation}
    </script></span></p>
    <p>where <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-12-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-255" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-256" class="mjx-mrow"><span id="MJXc-Node-257" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.12em;">T</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">T</script></span> is the Bellman operator, and <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-13-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-258" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-259" class="mjx-mrow"><span id="MJXc-Node-260" class="mjx-texatom"><span id="MJXc-Node-261" class="mjx-mrow"><span id="MJXc-Node-262" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.142em; padding-bottom: 0.376em;">v</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-13">\mathbf{v}</script></span> is seen as a fixed point of <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-14-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-263" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-264" class="mjx-mrow"><span id="MJXc-Node-265" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.12em;">T</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">T</script></span>: <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-15-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-266" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-267" class="mjx-mrow"><span id="MJXc-Node-268" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.12em;">T</span></span><span id="MJXc-Node-269" class="mjx-texatom"><span id="MJXc-Node-270" class="mjx-mrow"><span id="MJXc-Node-271" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.142em; padding-bottom: 0.376em;">v</span></span></span></span><span id="MJXc-Node-272" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.096em; padding-bottom: 0.329em;">=</span></span><span id="MJXc-Node-273" class="mjx-texatom MJXc-space3"><span id="MJXc-Node-274" class="mjx-mrow"><span id="MJXc-Node-275" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.142em; padding-bottom: 0.376em;">v</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-15">
    \begin{equation}
    T\mathbf{v} = \mathbf{v}
    \end{equation}
    </script></span></p>
    <p>Note that in finite spaces, we write <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-16-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-276" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-277" class="mjx-mrow"><span id="MJXc-Node-278" class="mjx-texatom"><span id="MJXc-Node-279" class="mjx-mrow"><span id="MJXc-Node-280" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.142em; padding-bottom: 0.376em;">r</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">r</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-16">\mathbf{r}</script></span> and <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-17-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;P&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-281" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-282" class="mjx-mrow"><span id="MJXc-Node-283" class="mjx-texatom"><span id="MJXc-Node-284" class="mjx-mrow"><span id="MJXc-Node-285" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.376em; padding-bottom: 0.376em;">P</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">P</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-17">\mathbf{P}</script></span> in matrix form where <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-18-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-286" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-287" class="mjx-mrow"><span id="MJXc-Node-288" class="mjx-texatom"><span id="MJXc-Node-289" class="mjx-mrow"><span id="MJXc-Node-290" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.142em; padding-bottom: 0.376em;">v</span></span></span></span><span id="MJXc-Node-291" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.236em; padding-bottom: 0.376em;">∈</span></span><span id="MJXc-Node-292" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-293" class="mjx-texatom"><span id="MJXc-Node-294" class="mjx-mrow"><span id="MJXc-Node-295" class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.423em; padding-bottom: 0.282em;">R</span></span></span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.615em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-296" class="mjx-texatom" style=""><span id="MJXc-Node-297" class="mjx-mrow"><span id="MJXc-Node-298" class="mjx-texatom"><span id="MJXc-Node-299" class="mjx-mrow"><span id="MJXc-Node-300" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">|</span></span></span></span><span id="MJXc-Node-301" class="mjx-texatom"><span id="MJXc-Node-302" class="mjx-mrow"><span id="MJXc-Node-303" class="mjx-mi"><span class="mjx-char MJXc-TeX-cal-R" style="padding-top: 0.423em; padding-bottom: 0.329em; padding-right: 0.036em;">S</span></span></span></span><span id="MJXc-Node-304" class="mjx-texatom"><span id="MJXc-Node-305" class="mjx-mrow"><span id="MJXc-Node-306" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">|</span></span></span></span><span id="MJXc-Node-307" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.189em; padding-bottom: 0.329em;">×</span></span><span id="MJXc-Node-308" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.376em; padding-bottom: 0.329em;">1</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo>∈</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">R</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">S</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>×</mo><mn>1</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-18">\mathbf{v} \in \mathbb{R}^{|\mathcal{S}| \times 1}</script></span>, <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-19-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-309" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-310" class="mjx-mrow"><span id="MJXc-Node-311" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-312" class="mjx-texatom"><span id="MJXc-Node-313" class="mjx-mrow"><span id="MJXc-Node-314" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.142em; padding-bottom: 0.376em;">r</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-315" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span></span><span id="MJXc-Node-316" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.236em; padding-bottom: 0.376em;">∈</span></span><span id="MJXc-Node-317" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-318" class="mjx-texatom"><span id="MJXc-Node-319" class="mjx-mrow"><span id="MJXc-Node-320" class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.423em; padding-bottom: 0.282em;">R</span></span></span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.615em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-321" class="mjx-texatom" style=""><span id="MJXc-Node-322" class="mjx-mrow"><span id="MJXc-Node-323" class="mjx-texatom"><span id="MJXc-Node-324" class="mjx-mrow"><span id="MJXc-Node-325" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">|</span></span></span></span><span id="MJXc-Node-326" class="mjx-texatom"><span id="MJXc-Node-327" class="mjx-mrow"><span id="MJXc-Node-328" class="mjx-mi"><span class="mjx-char MJXc-TeX-cal-R" style="padding-top: 0.423em; padding-bottom: 0.329em; padding-right: 0.036em;">S</span></span></span></span><span id="MJXc-Node-329" class="mjx-texatom"><span id="MJXc-Node-330" class="mjx-mrow"><span id="MJXc-Node-331" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">|</span></span></span></span><span id="MJXc-Node-332" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.189em; padding-bottom: 0.329em;">×</span></span><span id="MJXc-Node-333" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.376em; padding-bottom: 0.329em;">1</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">r</mi></mrow><mi>π</mi></msub><mo>∈</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">R</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">S</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>×</mo><mn>1</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-19">\mathbf{r}_\pi \in \mathbb{R}^{|\mathcal{S}| \times 1}</script></span>, <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-20-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;P&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-334" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-335" class="mjx-mrow"><span id="MJXc-Node-336" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-337" class="mjx-texatom"><span id="MJXc-Node-338" class="mjx-mrow"><span id="MJXc-Node-339" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.376em; padding-bottom: 0.376em;">P</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-340" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span></span><span id="MJXc-Node-341" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.236em; padding-bottom: 0.376em;">∈</span></span><span id="MJXc-Node-342" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-343" class="mjx-texatom"><span id="MJXc-Node-344" class="mjx-mrow"><span id="MJXc-Node-345" class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.423em; padding-bottom: 0.282em;">R</span></span></span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.615em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-346" class="mjx-texatom" style=""><span id="MJXc-Node-347" class="mjx-mrow"><span id="MJXc-Node-348" class="mjx-texatom"><span id="MJXc-Node-349" class="mjx-mrow"><span id="MJXc-Node-350" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">|</span></span></span></span><span id="MJXc-Node-351" class="mjx-texatom"><span id="MJXc-Node-352" class="mjx-mrow"><span id="MJXc-Node-353" class="mjx-mi"><span class="mjx-char MJXc-TeX-cal-R" style="padding-top: 0.423em; padding-bottom: 0.329em; padding-right: 0.036em;">S</span></span></span></span><span id="MJXc-Node-354" class="mjx-texatom"><span id="MJXc-Node-355" class="mjx-mrow"><span id="MJXc-Node-356" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">|</span></span></span></span><span id="MJXc-Node-357" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.189em; padding-bottom: 0.329em;">×</span></span><span id="MJXc-Node-358" class="mjx-texatom"><span id="MJXc-Node-359" class="mjx-mrow"><span id="MJXc-Node-360" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">|</span></span></span></span><span id="MJXc-Node-361" class="mjx-texatom"><span id="MJXc-Node-362" class="mjx-mrow"><span id="MJXc-Node-363" class="mjx-mi"><span class="mjx-char MJXc-TeX-cal-R" style="padding-top: 0.423em; padding-bottom: 0.329em; padding-right: 0.036em;">S</span></span></span></span><span id="MJXc-Node-364" class="mjx-texatom"><span id="MJXc-Node-365" class="mjx-mrow"><span id="MJXc-Node-366" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">|</span></span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">P</mi></mrow><mi>π</mi></msub><mo>∈</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">R</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">S</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>×</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">S</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-20">\mathbf{P}_\pi \in \mathbb{R}^{|\mathcal{S}| \times |\mathcal{S}|}</script></span>. In the stochastic case, we compute <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-21-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-367" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-368" class="mjx-mrow"><span id="MJXc-Node-369" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-370" class="mjx-texatom"><span id="MJXc-Node-371" class="mjx-mrow"><span id="MJXc-Node-372" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.142em; padding-bottom: 0.376em;">r</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-373" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">r</mi></mrow><mi>π</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-21">\mathbf{r}_\pi</script></span> and <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-22-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;P&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-374" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-375" class="mjx-mrow"><span id="MJXc-Node-376" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-377" class="mjx-texatom"><span id="MJXc-Node-378" class="mjx-mrow"><span id="MJXc-Node-379" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.376em; padding-bottom: 0.376em;">P</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-380" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">P</mi></mrow><mi>π</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-22">\mathbf{P}_\pi</script></span> as follows:</p>
    <p><span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-23-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/munder&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;P&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/munder&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-381" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-382" class="mjx-mrow"><span id="MJXc-Node-383" class="mjx-mtable" style="vertical-align: -1.971em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-384" class="mjx-mtr" style="height: 2.221em;"><span id="MJXc-Node-385" class="mjx-mtd" style="padding: 0px; text-align: right; width: 3.617em;"><span id="MJXc-Node-386" class="mjx-mrow" style="margin-top: -0.025em;"><span id="MJXc-Node-387" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-388" class="mjx-texatom"><span id="MJXc-Node-389" class="mjx-mrow"><span id="MJXc-Node-390" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.142em; padding-bottom: 0.376em;">r</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-391" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span></span><span id="MJXc-Node-392" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-393" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-394" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-395" class="mjx-mtd" style="padding: 0px; text-align: left; width: 9.909em;"><span id="MJXc-Node-396" class="mjx-mrow" style="margin-top: -0.025em;"><span id="MJXc-Node-397" class="mjx-mi"></span><span id="MJXc-Node-398" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.096em; padding-bottom: 0.329em;">=</span></span><span id="MJXc-Node-399" class="mjx-munderover MJXc-space3"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-400" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.749em; padding-bottom: 0.749em;">∑</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.757em;"><span id="MJXc-Node-401" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">a</span></span></span></span></span></span><span id="MJXc-Node-402" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span><span id="MJXc-Node-403" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-404" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">a</span></span><span id="MJXc-Node-405" class="mjx-mspace" style="width: 0.167em; height: 0px;"></span><span id="MJXc-Node-406" class="mjx-texatom"><span id="MJXc-Node-407" class="mjx-mrow"><span id="MJXc-Node-408" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">|</span></span></span></span><span id="MJXc-Node-409" class="mjx-mspace" style="width: 0.167em; height: 0px;"></span><span id="MJXc-Node-410" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-411" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span id="MJXc-Node-412" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">r</span></span><span id="MJXc-Node-413" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-414" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-415" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.184em; padding-bottom: 0.516em;">,</span></span><span id="MJXc-Node-416" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">a</span></span><span id="MJXc-Node-417" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-418" class="mjx-mtr" style="height: 2.221em;"><span id="MJXc-Node-419" class="mjx-mtd" style="padding: 0.15em 0px 0px; text-align: right;"><span id="MJXc-Node-420" class="mjx-mrow" style="margin-top: -0.025em;"><span id="MJXc-Node-421" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-422" class="mjx-texatom"><span id="MJXc-Node-423" class="mjx-mrow"><span id="MJXc-Node-424" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.376em; padding-bottom: 0.376em;">P</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-425" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span></span><span id="MJXc-Node-426" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-427" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-428" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.184em; padding-bottom: 0.516em;">,</span></span><span id="MJXc-Node-429" class="mjx-msup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-430" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-431" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.329em;">′</span></span></span></span><span id="MJXc-Node-432" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-433" class="mjx-mtd" style="padding: 0.15em 0px 0px; text-align: left;"><span id="MJXc-Node-434" class="mjx-mrow" style="margin-top: -0.025em;"><span id="MJXc-Node-435" class="mjx-mi"></span><span id="MJXc-Node-436" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.096em; padding-bottom: 0.329em;">=</span></span><span id="MJXc-Node-437" class="mjx-munderover MJXc-space3"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-438" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.749em; padding-bottom: 0.749em;">∑</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.757em;"><span id="MJXc-Node-439" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">a</span></span></span></span></span></span><span id="MJXc-Node-440" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span><span id="MJXc-Node-441" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-442" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">a</span></span><span id="MJXc-Node-443" class="mjx-mspace" style="width: 0.167em; height: 0px;"></span><span id="MJXc-Node-444" class="mjx-texatom"><span id="MJXc-Node-445" class="mjx-mrow"><span id="MJXc-Node-446" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">|</span></span></span></span><span id="MJXc-Node-447" class="mjx-mspace" style="width: 0.167em; height: 0px;"></span><span id="MJXc-Node-448" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-449" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span id="MJXc-Node-450" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-451" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-452" class="mjx-msup"><span class="mjx-base"><span id="MJXc-Node-453" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-454" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.329em;">′</span></span></span></span><span id="MJXc-Node-455" class="mjx-mspace" style="width: 0.167em; height: 0px;"></span><span id="MJXc-Node-456" class="mjx-texatom"><span id="MJXc-Node-457" class="mjx-mrow"><span id="MJXc-Node-458" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">|</span></span></span></span><span id="MJXc-Node-459" class="mjx-mspace" style="width: 0.167em; height: 0px;"></span><span id="MJXc-Node-460" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-461" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.184em; padding-bottom: 0.516em;">,</span></span><span id="MJXc-Node-462" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">a</span></span><span id="MJXc-Node-463" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">r</mi></mrow><mi>π</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><munder><mo>∑</mo><mi>a</mi></munder><mi>π</mi><mo stretchy="false">(</mo><mi>a</mi><mspace width="thinmathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mspace width="thinmathspace"></mspace><mi>s</mi><mo stretchy="false">)</mo><mi>r</mi><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">P</mi></mrow><mi>π</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><msup><mi>s</mi><mo>′</mo></msup><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><munder><mo>∑</mo><mi>a</mi></munder><mi>π</mi><mo stretchy="false">(</mo><mi>a</mi><mspace width="thinmathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mspace width="thinmathspace"></mspace><mi>s</mi><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><msup><mi>s</mi><mo>′</mo></msup><mspace width="thinmathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mspace width="thinmathspace"></mspace><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo></mtd></mtr></mtable></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-23">
    \begin{align*}
    \mathbf{r}_\pi(s) &= \sum_a \pi(a \,|\, s) r(s,a) \\
    \mathbf{P}_\pi(s,s') &= \sum_a \pi(a \,|\, s) P(s' \,|\, s, a)
    \end{align*}
    </script></span></p>
    <p>Equipped with this new view, we can prove the existence of a solution to the Bellman equations by piggybacking on <a href="https://en.wikipedia.org/wiki/Banach_fixed-point_theorem">Banach fixed-point theorem</a> and showing that <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-24-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-464" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-465" class="mjx-mrow"><span id="MJXc-Node-466" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.12em;">T</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-24">T</script></span> is a <a href="https://en.wikipedia.org/wiki/Contraction_mapping">contraction mapping</a> with respect to the <a href="https://en.wikipedia.org/wiki/Uniform_norm">sup-norm</a>.</p>
    <h2 id="mean-square-error">Mean Square Error</h2>
    <p>When we take the <em>learning</em> perspective to policy evaluation and control, it is convenient to consider the optimization-friendly <a href="https://en.wikipedia.org/wiki/Norm_(mathematics)#p-norm">l2 norm</a>.</p>
    <p>If we were to know the true value function <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-25-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-467" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-468" class="mjx-mrow"><span id="MJXc-Node-469" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-470" class="mjx-texatom"><span id="MJXc-Node-471" class="mjx-mrow"><span id="MJXc-Node-472" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.142em; padding-bottom: 0.376em;">v</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-473" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mi>π</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-25">\mathbf{v}_\pi</script></span> for policy <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-26-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-474" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-475" class="mjx-mrow"><span id="MJXc-Node-476" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-26">\pi</script></span>, it would be natural to minimize the mean-square error of our function estimate <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-27-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-477" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-478" class="mjx-mrow"><span id="MJXc-Node-479" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-480" class="mjx-texatom"><span id="MJXc-Node-481" class="mjx-mrow"><span id="MJXc-Node-482" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.142em; padding-bottom: 0.376em;">v</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-483" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mi>θ</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-27">\mathbf{v}_\theta</script></span>:</p>
    <p><span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-28-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtext&gt;MSE&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msub&gt;&lt;msubsup&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;/msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;M&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-484" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-485" class="mjx-mrow"><span id="MJXc-Node-486" class="mjx-mtable" style="vertical-align: -1.082em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-487" class="mjx-mtr" style="height: 1.337em;"><span id="MJXc-Node-488" class="mjx-mtd" style="padding: 0px; text-align: right; width: 3.401em;"><span id="MJXc-Node-489" class="mjx-mrow" style="margin-top: -0.14em;"><span id="MJXc-Node-490" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.376em;">MSE</span></span><span id="MJXc-Node-491" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-492" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span><span id="MJXc-Node-493" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-494" class="mjx-mtd" style="padding: 0px; text-align: left; width: 11.055em;"><span id="MJXc-Node-495" class="mjx-mrow" style="margin-top: -0.14em;"><span id="MJXc-Node-496" class="mjx-mi"></span><span id="MJXc-Node-497" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.096em; padding-bottom: 0.329em;">=</span></span><span id="MJXc-Node-498" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">∥</span></span><span id="MJXc-Node-499" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-500" class="mjx-texatom"><span id="MJXc-Node-501" class="mjx-mrow"><span id="MJXc-Node-502" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.142em; padding-bottom: 0.376em;">v</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-503" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span><span id="MJXc-Node-504" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.423em;">−</span></span><span id="MJXc-Node-505" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-506" class="mjx-texatom"><span id="MJXc-Node-507" class="mjx-mrow"><span id="MJXc-Node-508" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.142em; padding-bottom: 0.376em;">v</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-509" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span></span><span id="MJXc-Node-510" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-511" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">∥</span></span></span><span class="mjx-stack" style="vertical-align: -0.157em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-515" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.376em; padding-bottom: 0.329em;">2</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-512" class="mjx-texatom" style=""><span id="MJXc-Node-513" class="mjx-mrow"><span id="MJXc-Node-514" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.516em;">μ</span></span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-516" class="mjx-mtr" style="height: 1.328em;"><span id="MJXc-Node-517" class="mjx-mtd" style="padding: 0.15em 0px 0px; text-align: right;"><span id="MJXc-Node-518" class="mjx-mrow" style="margin-top: -0.097em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-519" class="mjx-mtd" style="padding: 0.15em 0px 0px; text-align: left;"><span id="MJXc-Node-520" class="mjx-mrow" style="margin-top: -0.097em;"><span id="MJXc-Node-521" class="mjx-mi"></span><span id="MJXc-Node-522" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.096em; padding-bottom: 0.329em;">=</span></span><span id="MJXc-Node-523" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-524" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-525" class="mjx-texatom"><span id="MJXc-Node-526" class="mjx-mrow"><span id="MJXc-Node-527" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.142em; padding-bottom: 0.376em;">v</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-528" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span><span id="MJXc-Node-529" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.423em;">−</span></span><span id="MJXc-Node-530" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-531" class="mjx-texatom"><span id="MJXc-Node-532" class="mjx-mrow"><span id="MJXc-Node-533" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.142em; padding-bottom: 0.376em;">v</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-534" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span></span><span id="MJXc-Node-535" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-536" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-537" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.376em; padding-bottom: 0.329em;">⊤</span></span></span></span><span id="MJXc-Node-538" class="mjx-texatom"><span id="MJXc-Node-539" class="mjx-mrow"><span id="MJXc-Node-540" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.376em; padding-bottom: 0.376em;">M</span></span></span></span><span id="MJXc-Node-541" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-542" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-543" class="mjx-texatom"><span id="MJXc-Node-544" class="mjx-mrow"><span id="MJXc-Node-545" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.142em; padding-bottom: 0.376em;">v</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-546" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span><span id="MJXc-Node-547" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.423em;">−</span></span><span id="MJXc-Node-548" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-549" class="mjx-texatom"><span id="MJXc-Node-550" class="mjx-mrow"><span id="MJXc-Node-551" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.142em; padding-bottom: 0.376em;">v</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-552" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span></span><span id="MJXc-Node-553" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mtext>MSE</mtext><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mo fence="false" stretchy="false">‖</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mi>θ</mi></msub><mo>−</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mi>π</mi></msub><msubsup><mo fence="false" stretchy="false">‖</mo><mrow class="MJX-TeXAtom-ORD"><mi>μ</mi></mrow><mn>2</mn></msubsup></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mi>θ</mi></msub><mo>−</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mi>π</mi></msub><msup><mo stretchy="false">)</mo><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">M</mi></mrow><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mi>θ</mi></msub><mo>−</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mi>π</mi></msub><mo stretchy="false">)</mo></mtd></mtr></mtable></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-28">
    \begin{align*}
    \text{MSE}(\theta) &= \| \mathbf{v}_\theta - \mathbf{v}_\pi \|^2_\mathbf{\mu} \\
    &= (\mathbf{v}_\theta - \mathbf{v}_\pi)^\top \mathbf{M} (\mathbf{v}_\theta - \mathbf{v}_\pi)
    \end{align*}
    </script></span> where <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-29-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;M&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-554" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-555" class="mjx-mrow"><span id="MJXc-Node-556" class="mjx-texatom"><span id="MJXc-Node-557" class="mjx-mrow"><span id="MJXc-Node-558" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.376em; padding-bottom: 0.376em;">M</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">M</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-29">\mathbf{M}</script></span> is the diagonal matrix containing the stationary distribution <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-30-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-559" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-560" class="mjx-mrow"><span id="MJXc-Node-561" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.516em;">μ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>μ</mi></math></span></span><script type="math/tex" id="MathJax-Element-30">\mu</script></span> induced by <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-31-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-562" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-563" class="mjx-mrow"><span id="MJXc-Node-564" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-31">\pi</script></span> in the given MDP.</p>
    <h2 id="td0">TD(0)</h2>
    <p>The RL way of optimizing this objective is through <a href="https://en.wikipedia.org/wiki/Stochastic_gradient_descent">stochastic gradient descent (SGD)</a> which in turns relies on the <a href="https://en.wikipedia.org/wiki/Stochastic_approximation">Robbins-Monro and Kiefer-Wolfowitz algorithms</a>. This algorithmic choice provides the <em>online</em> and <em>realtime</em> properties passionately sought for by RL algorithms designers.</p>
    <p>Let's then take the gradient of the MSE objective: <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-32-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mtext&gt;MSE&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;}&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-565" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-566" class="mjx-mrow"><span id="MJXc-Node-567" class="mjx-mtable" style="vertical-align: -3.788em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-568" class="mjx-mtr" style="height: 2.663em;"><span id="MJXc-Node-569" class="mjx-mtd" style="padding: 0px; text-align: right; width: 4.876em;"><span id="MJXc-Node-570" class="mjx-mrow"><span id="MJXc-Node-571" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.235em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.235em; top: -1.417em;"><span id="MJXc-Node-572" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.376em; padding-right: 0.035em;">∂</span></span></span><span class="mjx-denominator" style="width: 1.235em; bottom: -0.744em;"><span id="MJXc-Node-573" class="mjx-mrow"><span id="MJXc-Node-574" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.376em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-575" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.28em; width: 1.235em;"></span></span><span class="mjx-vsize" style="height: 2.16em; vertical-align: -0.744em;"></span></span><span id="MJXc-Node-576" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.376em;">MSE</span></span><span id="MJXc-Node-577" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-578" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span><span id="MJXc-Node-579" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-580" class="mjx-mtd" style="padding: 0px; text-align: left; width: 15.462em;"><span id="MJXc-Node-581" class="mjx-mrow" style="margin-top: 0.417em;"><span id="MJXc-Node-582" class="mjx-mi"></span><span id="MJXc-Node-583" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.096em; padding-bottom: 0.329em;">=</span></span><span id="MJXc-Node-584" class="mjx-munderover MJXc-space3"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-585" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.749em; padding-bottom: 0.749em;">∑</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.787em;"><span id="MJXc-Node-586" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span></span></span></span></span><span id="MJXc-Node-587" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-588" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.516em;">μ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-589" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span></span><span id="MJXc-Node-590" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-591" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-592" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span id="MJXc-Node-593" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-594" class="mjx-mrow"><span id="MJXc-Node-595" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-596" class="mjx-mrow"><span id="MJXc-Node-597" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-598" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.186em;">V</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-599" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span></span><span id="MJXc-Node-600" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-601" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-602" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span id="MJXc-Node-603" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.423em;">−</span></span><span id="MJXc-Node-604" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-605" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.186em;">V</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-606" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span><span id="MJXc-Node-607" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-608" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-609" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span></span><span id="MJXc-Node-610" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.71em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-611" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.376em; padding-bottom: 0.329em;">2</span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-612" class="mjx-mtr" style="height: 2.813em;"><span id="MJXc-Node-613" class="mjx-mtd" style="padding: 0.15em 0px 0px; text-align: right;"><span id="MJXc-Node-614" class="mjx-mrow" style="margin-top: 0.417em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-615" class="mjx-mtd" style="padding: 0.15em 0px 0px; text-align: left;"><span id="MJXc-Node-616" class="mjx-mrow"><span id="MJXc-Node-617" class="mjx-mi"></span><span id="MJXc-Node-618" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.096em; padding-bottom: 0.329em;">=</span></span><span id="MJXc-Node-619" class="mjx-munderover MJXc-space3"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-620" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.749em; padding-bottom: 0.749em;">∑</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.787em;"><span id="MJXc-Node-621" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span></span></span></span></span><span id="MJXc-Node-622" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-623" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.516em;">μ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-624" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span></span><span id="MJXc-Node-625" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-626" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-627" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span id="MJXc-Node-628" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-629" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-630" class="mjx-mrow"><span id="MJXc-Node-631" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-632" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.186em;">V</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-633" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span></span><span id="MJXc-Node-634" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-635" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-636" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span id="MJXc-Node-637" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.423em;">−</span></span><span id="MJXc-Node-638" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-639" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.186em;">V</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-640" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span><span id="MJXc-Node-641" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-642" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-643" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span></span><span id="MJXc-Node-644" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span></span><span id="MJXc-Node-645" class="mjx-mfrac MJXc-space1"><span class="mjx-box MJXc-stacked" style="width: 1.235em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.235em; top: -1.417em;"><span id="MJXc-Node-646" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.376em; padding-right: 0.035em;">∂</span></span></span><span class="mjx-denominator" style="width: 1.235em; bottom: -0.744em;"><span id="MJXc-Node-647" class="mjx-mrow"><span id="MJXc-Node-648" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.376em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-649" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.28em; width: 1.235em;"></span></span><span class="mjx-vsize" style="height: 2.16em; vertical-align: -0.744em;"></span></span><span id="MJXc-Node-650" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-651" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.186em;">V</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-652" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span><span id="MJXc-Node-653" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-654" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-655" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-656" class="mjx-mtr" style="height: 2.599em;"><span id="MJXc-Node-657" class="mjx-mtd" style="padding: 0.15em 0px 0px; text-align: right;"><span id="MJXc-Node-658" class="mjx-mrow" style="margin-top: 0.475em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-659" class="mjx-mtd" style="padding: 0.15em 0px 0px; text-align: left;"><span id="MJXc-Node-660" class="mjx-mrow"><span id="MJXc-Node-661" class="mjx-mi"></span><span id="MJXc-Node-662" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.096em; padding-bottom: 0.329em;">=</span></span><span id="MJXc-Node-663" class="mjx-texatom MJXc-space3"><span id="MJXc-Node-664" class="mjx-mrow"><span id="MJXc-Node-665" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-666" class="mjx-texatom"><span id="MJXc-Node-667" class="mjx-mrow"><span id="MJXc-Node-668" class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.423em; padding-bottom: 0.282em;">E</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-669" class="mjx-texatom" style=""><span id="MJXc-Node-670" class="mjx-mrow"><span id="MJXc-Node-671" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-672" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.096em; padding-bottom: 0.329em;">∼</span></span><span id="MJXc-Node-673" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-674" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.516em;">μ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-675" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span></span></span></span></span></span></span></span><span id="MJXc-Node-676" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-677" class="mjx-mrow"><span id="MJXc-Node-678" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.216em; padding-bottom: 1.216em;">{</span></span><span id="MJXc-Node-679" class="mjx-mrow"><span id="MJXc-Node-680" class="mjx-mrow"><span id="MJXc-Node-681" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-682" class="mjx-mrow"><span id="MJXc-Node-683" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-684" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.186em;">V</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-685" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span></span><span id="MJXc-Node-686" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-687" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-688" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span id="MJXc-Node-689" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.423em;">−</span></span><span id="MJXc-Node-690" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-691" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.186em;">V</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-692" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span><span id="MJXc-Node-693" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-694" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-695" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span></span><span id="MJXc-Node-696" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span></span><span id="MJXc-Node-697" class="mjx-mfrac MJXc-space1"><span class="mjx-box MJXc-stacked" style="width: 1.235em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.235em; top: -1.417em;"><span id="MJXc-Node-698" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.376em; padding-right: 0.035em;">∂</span></span></span><span class="mjx-denominator" style="width: 1.235em; bottom: -0.744em;"><span id="MJXc-Node-699" class="mjx-mrow"><span id="MJXc-Node-700" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.376em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-701" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.28em; width: 1.235em;"></span></span><span class="mjx-vsize" style="height: 2.16em; vertical-align: -0.744em;"></span></span><span id="MJXc-Node-702" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-703" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.186em;">V</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-704" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span><span id="MJXc-Node-705" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-706" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-707" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span></span><span id="MJXc-Node-708" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.216em; padding-bottom: 1.216em;">}</span></span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mtext>MSE</mtext><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><munder><mo>∑</mo><mi>s</mi></munder><msub><mi>μ</mi><mi>π</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><msup><mrow><mo>(</mo><mrow><msub><mi>V</mi><mi>π</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>−</mo><msub><mi>V</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><munder><mo>∑</mo><mi>s</mi></munder><msub><mi>μ</mi><mi>π</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mrow><mo>(</mo><mrow><msub><mi>V</mi><mi>π</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>−</mo><msub><mi>V</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><msub><mi>V</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mrow class="MJX-TeXAtom-OP"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>s</mi><mo>∼</mo><msub><mi>μ</mi><mi>π</mi></msub></mrow></msub></mrow><mo>⁡</mo><mrow><mo>{</mo><mrow><mrow><mo>(</mo><mrow><msub><mi>V</mi><mi>π</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>−</mo><msub><mi>V</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><msub><mi>V</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><mo>}</mo></mrow></mtd></mtr></mtable></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-32">
    \begin{align}
    \frac{\partial}{\partial\theta} \text{MSE}(\theta) &= \sum_s \mu_\pi(s)\left( V_\pi(s) - V_\theta(s) \right)^2 \notag \\
    &= \sum_s \mu_\pi(s) \left( V_\pi(s) - V_\theta(s) \right) \frac{\partial}{\partial\theta} V_\theta(s) \notag \\
    &= \mathop{\mathbb{E}_{s \sim \mu_\pi}}\left\{ \left( V_\pi(s) - V_\theta(s) \right) \frac{\partial}{\partial\theta} V_\theta(s) \notag \right\}
    \end{align}
    </script></span></p>
    <p>Now, this is not the end of the story. We have two problems:</p>
    <ol style="list-style-type: decimal">
    <li>We don't know the true target <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-33-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-709" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-710" class="mjx-mrow"><span id="MJXc-Node-711" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-712" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.186em;">V</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-713" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>V</mi><mi>π</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-33">V_\pi</script></span></li>
    <li>We don't know the MDP</li>
    </ol>
    <p>As opposed to the supervised learning setting, we don't have training targets in the form of true values for <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-34-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-714" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-715" class="mjx-mrow"><span id="MJXc-Node-716" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-717" class="mjx-texatom"><span id="MJXc-Node-718" class="mjx-mrow"><span id="MJXc-Node-719" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.142em; padding-bottom: 0.376em;">v</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-720" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mi>π</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-34">\mathbf{v}_\pi</script></span>. A straightforward solution in episodic problems might consist in performing rollouts from every state and averaging the returns in a <a href="https://en.wikipedia.org/wiki/Monte_Carlo_method">Monte Carlo (MC)</a> fashion. However, since the number of possible paths quickly explodes as a function of the length of the trajectories, the variance of such estimates would most likely be pretty high.</p>
    <p>The TD way of solving this problem is by taking the following approximation: <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-35-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;}&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-721" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-722" class="mjx-mrow"><span id="MJXc-Node-723" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-724" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.186em;">V</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-725" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span></span><span id="MJXc-Node-726" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-727" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-728" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span id="MJXc-Node-729" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.189em; padding-bottom: 0.329em;">≈</span></span><span id="MJXc-Node-730" class="mjx-texatom MJXc-space3"><span id="MJXc-Node-731" class="mjx-mrow"><span id="MJXc-Node-732" class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.423em; padding-bottom: 0.282em;">E</span></span></span></span><span id="MJXc-Node-733" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-734" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.609em; padding-bottom: 0.609em;">{</span></span><span id="MJXc-Node-735" class="mjx-mrow"><span id="MJXc-Node-736" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">r</span></span><span id="MJXc-Node-737" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-738" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-739" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.184em; padding-bottom: 0.516em;">,</span></span><span id="MJXc-Node-740" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">a</span></span><span id="MJXc-Node-741" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span id="MJXc-Node-742" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.423em;">+</span></span><span id="MJXc-Node-743" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.516em; padding-right: 0.025em;">γ</span></span><span id="MJXc-Node-744" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-745" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.186em;">V</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-746" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span><span id="MJXc-Node-747" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-748" class="mjx-msup"><span class="mjx-base"><span id="MJXc-Node-749" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-750" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.329em;">′</span></span></span></span><span id="MJXc-Node-751" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span id="MJXc-Node-752" class="mjx-mspace" style="width: 0.167em; height: 0px;"></span><span id="MJXc-Node-753" class="mjx-texatom"><span id="MJXc-Node-754" class="mjx-mrow"><span id="MJXc-Node-755" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">|</span></span></span></span><span id="MJXc-Node-756" class="mjx-mspace" style="width: 0.167em; height: 0px;"></span><span id="MJXc-Node-757" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-758" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.184em; padding-bottom: 0.516em;">,</span></span><span id="MJXc-Node-759" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span><span id="MJXc-Node-760" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.609em; padding-bottom: 0.609em;">}</span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>V</mi><mi>π</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>≈</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow><mo>{</mo><mrow><mi>r</mi><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>+</mo><mi>γ</mi><msub><mi>V</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msup><mi>s</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mspace width="thinmathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mspace width="thinmathspace"></mspace><mi>s</mi><mo>,</mo><mi>π</mi></mrow><mo>}</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-35">
    \begin{equation}
    V_\pi(s) \approx \mathbb{E}\left\{ r(s,a) + \gamma V_\theta(s') \,|\, s, \pi \right\}
    \end{equation}
    </script></span></p>
    <p>This approximation is essentially the one-step application of the Bellman operator on the estimate <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-36-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-761" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-762" class="mjx-mrow"><span id="MJXc-Node-763" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-764" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.186em;">V</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-765" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>V</mi><mi>θ</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-36">V_\theta</script></span>. This idea is called <strong>bootstrapping</strong> and is a cornerstone of temporal difference learning.</p>
    <p>The second problem has to do with the fundamental RL assumption that the transition and reward functions are either unknown or intractable to work with. We therefore have to find a way to compute the expectation. If we have access to a simulator (an <em>environment</em>), we can draw samples of this expectation rather than explicitely integrating it over the MDP. In the spirit of <em>stochastic approximation</em>, we won't however have to take more than one sample and rather rely on the stationary distribution to do the averaging.</p>
    <p>Combining these two ideas, bootstrapping and stochastic approximation, we get the TD algorithm: <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-37-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mtext&gt;MSE&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;:=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mtext&gt;MSE&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-766" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-767" class="mjx-mrow"><span id="MJXc-Node-768" class="mjx-mtable" style="vertical-align: -3.29em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-769" class="mjx-mtr" style="height: 2.31em;"><span id="MJXc-Node-770" class="mjx-mtd" style="padding: 0px; text-align: right; width: 4.876em;"><span id="MJXc-Node-771" class="mjx-mrow"><span id="MJXc-Node-772" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.235em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.235em; top: -1.417em;"><span id="MJXc-Node-773" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.376em; padding-right: 0.035em;">∂</span></span></span><span class="mjx-denominator" style="width: 1.235em; bottom: -0.744em;"><span id="MJXc-Node-774" class="mjx-mrow"><span id="MJXc-Node-775" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.376em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-776" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.28em; width: 1.235em;"></span></span><span class="mjx-vsize" style="height: 2.16em; vertical-align: -0.744em;"></span></span><span id="MJXc-Node-777" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.376em;">MSE</span></span><span id="MJXc-Node-778" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-779" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span><span id="MJXc-Node-780" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-781" class="mjx-mtd" style="padding: 0px; text-align: left; width: 16.372em;"><span id="MJXc-Node-782" class="mjx-mrow"><span id="MJXc-Node-783" class="mjx-mi"></span><span id="MJXc-Node-784" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.189em; padding-bottom: 0.329em;">≈</span></span><span id="MJXc-Node-785" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-786" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.609em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-787" class="mjx-mrow"><span id="MJXc-Node-788" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">r</span></span><span id="MJXc-Node-789" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-790" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-791" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.184em; padding-bottom: 0.516em;">,</span></span><span id="MJXc-Node-792" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">a</span></span><span id="MJXc-Node-793" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span id="MJXc-Node-794" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.423em;">+</span></span><span id="MJXc-Node-795" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.516em; padding-right: 0.025em;">γ</span></span><span id="MJXc-Node-796" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-797" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.186em;">V</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-798" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span><span id="MJXc-Node-799" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-800" class="mjx-msup"><span class="mjx-base"><span id="MJXc-Node-801" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-802" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.329em;">′</span></span></span></span><span id="MJXc-Node-803" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span id="MJXc-Node-804" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.423em;">−</span></span><span id="MJXc-Node-805" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-806" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.186em;">V</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-807" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span><span id="MJXc-Node-808" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-809" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-810" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span></span><span id="MJXc-Node-811" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.609em; padding-bottom: 0.609em;">)</span></span></span><span id="MJXc-Node-812" class="mjx-mfrac MJXc-space1"><span class="mjx-box MJXc-stacked" style="width: 1.235em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.235em; top: -1.417em;"><span id="MJXc-Node-813" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.376em; padding-right: 0.035em;">∂</span></span></span><span class="mjx-denominator" style="width: 1.235em; bottom: -0.744em;"><span id="MJXc-Node-814" class="mjx-mrow"><span id="MJXc-Node-815" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.376em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-816" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.28em; width: 1.235em;"></span></span><span class="mjx-vsize" style="height: 2.16em; vertical-align: -0.744em;"></span></span><span id="MJXc-Node-817" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-818" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.186em;">V</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-819" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span><span id="MJXc-Node-820" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-821" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-822" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-823" class="mjx-mtr" style="height: 2.46em;"><span id="MJXc-Node-824" class="mjx-mtd" style="padding: 0.15em 0px 0px; text-align: right;"><span id="MJXc-Node-825" class="mjx-mrow" style="margin-top: 0.417em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-826" class="mjx-mtd" style="padding: 0.15em 0px 0px; text-align: left;"><span id="MJXc-Node-827" class="mjx-mrow"><span id="MJXc-Node-828" class="mjx-mi"></span><span id="MJXc-Node-829" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.096em; padding-bottom: 0.329em;">:<span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">=</span></span></span><span id="MJXc-Node-830" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.007em;"><span id="MJXc-Node-831" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.516em; padding-bottom: 0.282em; padding-right: 0.007em;">δ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-832" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span><span id="MJXc-Node-833" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.235em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.235em; top: -1.417em;"><span id="MJXc-Node-834" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.376em; padding-right: 0.035em;">∂</span></span></span><span class="mjx-denominator" style="width: 1.235em; bottom: -0.744em;"><span id="MJXc-Node-835" class="mjx-mrow"><span id="MJXc-Node-836" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.376em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-837" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.28em; width: 1.235em;"></span></span><span class="mjx-vsize" style="height: 2.16em; vertical-align: -0.744em;"></span></span><span id="MJXc-Node-838" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-839" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.186em;">V</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-840" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span><span id="MJXc-Node-841" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-842" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-843" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-844" class="mjx-mtr" style="height: 2.31em;"><span id="MJXc-Node-845" class="mjx-mtd" style="padding: 0.15em 0px 0px; text-align: right;"><span id="MJXc-Node-846" class="mjx-mrow" style="margin-top: 0.417em;"><span id="MJXc-Node-847" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-848" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-849" class="mjx-texatom" style=""><span id="MJXc-Node-850" class="mjx-mrow"><span id="MJXc-Node-851" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.282em;">t</span></span><span id="MJXc-Node-852" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.423em;">+</span></span><span id="MJXc-Node-853" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.376em; padding-bottom: 0.329em;">1</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-854" class="mjx-mtd" style="padding: 0.15em 0px 0px; text-align: left;"><span id="MJXc-Node-855" class="mjx-mrow"><span id="MJXc-Node-856" class="mjx-mi"></span><span id="MJXc-Node-857" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.096em; padding-bottom: 0.329em;">=</span></span><span id="MJXc-Node-858" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-859" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-860" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.282em;">t</span></span></span></span><span id="MJXc-Node-861" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.423em;">+</span></span><span id="MJXc-Node-862" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">α</span></span><span id="MJXc-Node-863" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.235em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.235em; top: -1.417em;"><span id="MJXc-Node-864" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.376em; padding-right: 0.035em;">∂</span></span></span><span class="mjx-denominator" style="width: 1.235em; bottom: -0.744em;"><span id="MJXc-Node-865" class="mjx-mrow"><span id="MJXc-Node-866" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.376em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-867" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.28em; width: 1.235em;"></span></span><span class="mjx-vsize" style="height: 2.16em; vertical-align: -0.744em;"></span></span><span id="MJXc-Node-868" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.376em;">MSE</span></span><span id="MJXc-Node-869" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-870" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span><span id="MJXc-Node-871" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mtext>MSE</mtext><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>≈</mo><mrow><mo>(</mo><mrow><mi>r</mi><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>+</mo><mi>γ</mi><msub><mi>V</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msup><mi>s</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mo>−</mo><msub><mi>V</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><msub><mi>V</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>:=</mo><msub><mi>δ</mi><mi>θ</mi></msub><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><msub><mi>V</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>θ</mi><mi>t</mi></msub><mo>+</mo><mi>α</mi><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mtext>MSE</mtext><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mtd></mtr></mtable></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-37">
    \begin{align*}
    \frac{\partial}{\partial\theta} \text{MSE}(\theta) &\approx \left(r(s,a) + \gamma V_\theta(s') - V_\theta(s)\right)\frac{\partial}{\partial\theta} V_\theta(s) \\
    &:= \delta_\theta \frac{\partial}{\partial\theta} V_\theta(s) \\
    \theta_{t+1} &= \theta_t + \alpha \frac{\partial}{\partial\theta} \text{MSE}(\theta)
    \end{align*}
    </script></span></p>
    <p>The symbol <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-38-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-872" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-873" class="mjx-mrow"><span id="MJXc-Node-874" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.516em; padding-bottom: 0.282em; padding-right: 0.007em;">δ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>δ</mi></math></span></span><script type="math/tex" id="MathJax-Element-38">\delta</script></span> is often use to denote the so-called <em>TD error</em>. Note that when using function approximation, if the function space is not rich enough, it might be impossible to represent the value function after one step of the Bellman operator. This discussion would lead us to consider the <em>projected</em> version of the Mean-Square Bellman Error criterion.</p>
    <h2 id="mean-square-bellman-error">Mean-Square Bellman Error</h2>
    <p>We saw how TD(0) gets around the problem of setting up learning target with Bootstrapping. Although the derivation of TD(0) starts from the MSE criterion, it would be more natural to consider an objective which directly incorporates boostrapping.</p>
    <p>We define the Mean Square Bellman Error (MSBE) as:</p>
    <p><span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-39-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtext&gt;MSBE&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;msubsup&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-875" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-876" class="mjx-mrow"><span id="MJXc-Node-877" class="mjx-mtable" style="vertical-align: -3.234em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-878" class="mjx-mtr" style="height: 1.357em;"><span id="MJXc-Node-879" class="mjx-mtd" style="padding: 0px; text-align: right; width: 4.109em;"><span id="MJXc-Node-880" class="mjx-mrow" style="margin-top: -0.14em;"><span id="MJXc-Node-881" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.376em;">MSBE</span></span><span id="MJXc-Node-882" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-883" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span><span id="MJXc-Node-884" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-885" class="mjx-mtd" style="padding: 0px; text-align: left; width: 23.043em;"><span id="MJXc-Node-886" class="mjx-mrow" style="margin-top: -0.14em;"><span id="MJXc-Node-887" class="mjx-mi"></span><span id="MJXc-Node-888" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.096em; padding-bottom: 0.329em;">=</span></span><span id="MJXc-Node-889" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">∥</span></span><span id="MJXc-Node-890" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-891" class="mjx-texatom"><span id="MJXc-Node-892" class="mjx-mrow"><span id="MJXc-Node-893" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.142em; padding-bottom: 0.376em;">v</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-894" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span><span id="MJXc-Node-895" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.423em;">−</span></span><span id="MJXc-Node-896" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.12em;">T</span></span><span id="MJXc-Node-897" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-898" class="mjx-texatom"><span id="MJXc-Node-899" class="mjx-mrow"><span id="MJXc-Node-900" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.142em; padding-bottom: 0.376em;">v</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-901" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span><span id="MJXc-Node-902" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-903" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">∥</span></span></span><span class="mjx-stack" style="vertical-align: -0.329em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-907" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.376em; padding-bottom: 0.329em;">2</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-904" class="mjx-texatom" style=""><span id="MJXc-Node-905" class="mjx-mrow"><span id="MJXc-Node-906" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.376em; padding-bottom: 0.376em;">D</span></span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-908" class="mjx-mtr" style="height: 2.372em;"><span id="MJXc-Node-909" class="mjx-mtd" style="padding: 0.15em 0px 0px; text-align: right;"><span id="MJXc-Node-910" class="mjx-mrow" style="margin-top: -0.025em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-911" class="mjx-mtd" style="padding: 0.15em 0px 0px; text-align: left;"><span id="MJXc-Node-912" class="mjx-mrow" style="margin-top: -0.025em;"><span id="MJXc-Node-913" class="mjx-mi"></span><span id="MJXc-Node-914" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.096em; padding-bottom: 0.329em;">=</span></span><span id="MJXc-Node-915" class="mjx-munderover MJXc-space3"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-916" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.749em; padding-bottom: 0.749em;">∑</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.787em;"><span id="MJXc-Node-917" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span></span></span></span></span><span id="MJXc-Node-918" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-919" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.003em;">d</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-920" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span></span><span id="MJXc-Node-921" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-922" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-923" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span id="MJXc-Node-924" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-925" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-926" class="mjx-mrow"><span id="MJXc-Node-927" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-928" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.186em;">V</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-929" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span><span id="MJXc-Node-930" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-931" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-932" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span id="MJXc-Node-933" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.423em;">−</span></span><span id="MJXc-Node-934" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.12em;">T</span></span><span id="MJXc-Node-935" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-936" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.186em;">V</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-937" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span><span id="MJXc-Node-938" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-939" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-940" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span></span><span id="MJXc-Node-941" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-942" class="mjx-mtr" style="height: 3.241em;"><span id="MJXc-Node-943" class="mjx-mtd" style="padding: 0.15em 0px 0px; text-align: right;"><span id="MJXc-Node-944" class="mjx-mrow" style="margin-top: 0.775em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-945" class="mjx-mtd" style="padding: 0.15em 0px 0px; text-align: left;"><span id="MJXc-Node-946" class="mjx-mrow"><span id="MJXc-Node-947" class="mjx-mi"></span><span id="MJXc-Node-948" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.096em; padding-bottom: 0.329em;">=</span></span><span id="MJXc-Node-949" class="mjx-munderover MJXc-space3"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-950" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.749em; padding-bottom: 0.749em;">∑</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.787em;"><span id="MJXc-Node-951" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span></span></span></span></span><span id="MJXc-Node-952" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-953" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.003em;">d</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-954" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span></span><span id="MJXc-Node-955" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-956" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-957" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span id="MJXc-Node-958" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-959" class="mjx-mo"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 1.543em; padding-bottom: 1.543em;">(</span></span><span id="MJXc-Node-960" class="mjx-mrow"><span id="MJXc-Node-961" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-962" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.186em;">V</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-963" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span><span id="MJXc-Node-964" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-965" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-966" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span id="MJXc-Node-967" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.423em;">−</span></span><span id="MJXc-Node-968" class="mjx-mrow MJXc-space2"><span id="MJXc-Node-969" class="mjx-mo"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 1.543em; padding-bottom: 1.543em;">(</span></span><span id="MJXc-Node-970" class="mjx-mrow"><span id="MJXc-Node-971" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-972" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">r</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-973" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span></span><span id="MJXc-Node-974" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-975" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-976" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span id="MJXc-Node-977" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.423em;">+</span></span><span id="MJXc-Node-978" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.516em; padding-right: 0.025em;">γ</span></span><span id="MJXc-Node-979" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-980" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.749em; padding-bottom: 0.749em;">∑</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.672em;"><span id="MJXc-Node-981" class="mjx-texatom" style=""><span id="MJXc-Node-982" class="mjx-mrow"><span id="MJXc-Node-983" class="mjx-msup"><span class="mjx-base"><span id="MJXc-Node-984" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-985" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.329em;">′</span></span></span></span></span></span></span></span></span></span><span id="MJXc-Node-986" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.109em;"><span id="MJXc-Node-987" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.109em;">P</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-988" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.189em; padding-bottom: 0.282em; padding-right: 0.003em;">π</span></span></span></span><span id="MJXc-Node-989" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-990" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span><span id="MJXc-Node-991" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.184em; padding-bottom: 0.516em;">,</span></span><span id="MJXc-Node-992" class="mjx-msup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-993" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-994" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.329em;">′</span></span></span></span><span id="MJXc-Node-995" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span id="MJXc-Node-996" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-997" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.186em;">V</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-998" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span><span id="MJXc-Node-999" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-1000" class="mjx-msup"><span class="mjx-base"><span id="MJXc-Node-1001" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">s</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1002" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.329em;">′</span></span></span></span><span id="MJXc-Node-1003" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span></span><span id="MJXc-Node-1004" class="mjx-mo"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 1.543em; padding-bottom: 1.543em;">)</span></span></span></span><span id="MJXc-Node-1005" class="mjx-mo"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 1.543em; padding-bottom: 1.543em;">)</span></span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mtext>MSBE</mtext><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mo fence="false" stretchy="false">‖</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mi>θ</mi></msub><mo>−</mo><mi>T</mi><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mi>θ</mi></msub><msubsup><mo fence="false" stretchy="false">‖</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">D</mi></mrow><mn>2</mn></msubsup></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><munder><mo>∑</mo><mi>s</mi></munder><msub><mi>d</mi><mi>π</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mrow><mo>(</mo><mrow><msub><mi>V</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>−</mo><mi>T</mi><msub><mi>V</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><munder><mo>∑</mo><mi>s</mi></munder><msub><mi>d</mi><mi>π</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mrow><mo>(</mo><mrow><msub><mi>V</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>−</mo><mrow><mo>(</mo><mrow><msub><mi>r</mi><mi>π</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>+</mo><mi>γ</mi><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>s</mi><mo>′</mo></msup></mrow></munder><msub><mi>P</mi><mi>π</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><msup><mi>s</mi><mo>′</mo></msup><mo stretchy="false">)</mo><msub><mi>V</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msup><mi>s</mi><mo>′</mo></msup><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mtd></mtr></mtable></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-39">
    \begin{align*}
    \text{MSBE}(\theta) &= \| \mathbf{v}_\theta - T\mathbf{v}_\theta \|^2_\mathbf{D} \\
    &= \sum_s d_\pi(s)\left( V_\theta(s) - T V_\theta(s) \right) \\
    &= \sum_s d_\pi(s)\left( V_\theta(s) - \left(r_\pi(s) + \gamma \sum_{s'} P_\pi(s, s') V_\theta(s')\right)\right)
    \end{align*}
    </script></span></p>
    <h2 id="the-n-steps-bellman-operator">The n-steps Bellman operator</h2>
    <p>As pointed out earlier, an issue with MC methods is their high variance. Bootstrapping mitigates this problem by only considering one-step extensions into the future at the cost of a higher bias. It would then be natural to attempt to balance this tradeoff by considering longer backups (also called <em>n-steps lookaheads</em>). We define the n-steps Bellman operator as follows:</p>
    <p><span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-40-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;munder&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;munder&gt;&lt;mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x23DF;&lt;/mo&gt;&lt;/munder&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;times&lt;/mtext&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2261;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-1006" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1007" class="mjx-mrow"><span id="MJXc-Node-1008" class="mjx-munderover"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-1009" class="mjx-texatom"><span id="MJXc-Node-1010" class="mjx-mrow"><span id="MJXc-Node-1011" class="mjx-munderover"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op" style="padding-left: 0.103em;"><span id="MJXc-Node-1012" class="mjx-mrow"><span id="MJXc-Node-1013" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.12em;">T</span></span><span id="MJXc-Node-1014" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.12em;">T</span></span><span id="MJXc-Node-1015" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.12em;">T</span></span><span id="MJXc-Node-1016" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.184em; padding-bottom: 0.329em;">.</span></span><span id="MJXc-Node-1017" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.184em; padding-bottom: 0.329em;">.</span></span><span id="MJXc-Node-1018" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.184em; padding-bottom: 0.329em;">.</span></span><span id="MJXc-Node-1019" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.12em;">T</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="padding-top: 0.12em;"><span id="MJXc-Node-1020" class="mjx-mo"><span class="mjx-delim-h"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.108em; padding-bottom: 0.488em; margin: 0px 0.01em 0px 0.024em;"></span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.108em; padding-bottom: 0.488em; margin: 0px 0.104em 0px -0.084em; letter-spacing: -0.117em;"></span><span class="mjx-char MJXc-TeX-size4-R" style="margin-top: 0px; padding-bottom: 0.488em; margin-right: 0.01em; padding-top: 0.108em; margin-bottom: 0px;"></span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.108em; padding-bottom: 0.488em; margin: 0px 0.104em 0px -0.084em; letter-spacing: -0.117em;"></span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.108em; padding-bottom: 0.488em; margin-right: 0.024em; margin-bottom: 0px; margin-top: 0px;"></span></span></span></span></span></span></span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 1.413em;"><span id="MJXc-Node-1021" class="mjx-texatom" style=""><span id="MJXc-Node-1022" class="mjx-mrow"><span id="MJXc-Node-1023" class="mjx-mrow"><span id="MJXc-Node-1024" class="mjx-texatom"><span id="MJXc-Node-1025" class="mjx-mrow"><span id="MJXc-Node-1026" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">n</span></span></span></span><span id="MJXc-Node-1027" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.376em; padding-bottom: 0.329em;">&nbsp;times</span></span></span></span></span></span></span></span></span><span id="MJXc-Node-1028" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-1029" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.186em;">V</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-1030" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span><span id="MJXc-Node-1031" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.189em; padding-bottom: 0.329em;">≡</span></span><span id="MJXc-Node-1032" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.12em;"><span id="MJXc-Node-1033" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.12em;">T</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.291em; padding-right: 0.071em;"><span id="MJXc-Node-1034" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.236em; padding-bottom: 0.282em;">n</span></span></span></span><span id="MJXc-Node-1035" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-1036" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.186em;">V</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-1037" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">θ</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><munder><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><munder><mrow><mi>T</mi><mi>T</mi><mi>T</mi><mo>.</mo><mo>.</mo><mo>.</mo><mi>T</mi></mrow><mo>⏟</mo></munder></mrow><mrow class="MJX-TeXAtom-ORD"><mrow><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow><mtext>&nbsp;times</mtext></mrow></mrow></munder><msub><mi>V</mi><mi>θ</mi></msub><mo>≡</mo><msup><mi>T</mi><mi>n</mi></msup><msub><mi>V</mi><mi>θ</mi></msub></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-40">
    \begin{equation}
    \underbrace{TTT ... T}_{\text{$n$ times}} V_\theta \equiv T^n V_\theta
    \end{equation}
    </script></span></p>
    <h2 id="the-lambda-bellman-operator">The <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-41-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-1038" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1039" class="mjx-mrow"><span id="MJXc-Node-1040" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.478em; padding-bottom: 0.282em;">λ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>λ</mi></math></span></span><script type="math/tex" id="MathJax-Element-41">\lambda</script></span>-Bellman operator</h2>
    <p>The <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-42-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-1041" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1042" class="mjx-mrow"><span id="MJXc-Node-1043" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">λ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>λ</mi></math></span></span><script type="math/tex" id="MathJax-Element-42">\lambda</script></span>-Bellman operator will allow us to explore the full spectrum from boostrapping on one end to Monte-Carlo on the other through a real parameter <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-43-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-1044" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1045" class="mjx-mrow"><span id="MJXc-Node-1046" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">λ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>λ</mi></math></span></span><script type="math/tex" id="MathJax-Element-43">\lambda</script></span> ranging from 0 to 1. Rather than taking only one n-steps backup, we will also take a geometrically-weighted combination of multi-steps backups. We write the <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-44-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-1047" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1048" class="mjx-mrow"><span id="MJXc-Node-1049" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">λ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>λ</mi></math></span></span><script type="math/tex" id="MathJax-Element-44">\lambda</script></span>-Bellman operator as:</p>
    <p><span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-45-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x221E;&lt;/mi&gt;&lt;/munderover&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; text-align: center; position: relative;"><span id="MJXc-Node-1050" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1051" class="mjx-mrow"><span id="MJXc-Node-1052" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.12em;"><span id="MJXc-Node-1053" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.12em;">T</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-1054" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">λ</span></span></span></span><span id="MJXc-Node-1055" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.096em; padding-bottom: 0.329em;">=</span></span><span id="MJXc-Node-1056" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-1057" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.376em; padding-bottom: 0.329em;">1</span></span><span id="MJXc-Node-1058" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.423em;">−</span></span><span id="MJXc-Node-1059" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">λ</span></span><span id="MJXc-Node-1060" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span><span id="MJXc-Node-1061" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.247em; padding-top: 0.141em; padding-left: 0.521em;"><span id="MJXc-Node-1068" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.142em; padding-bottom: 0.329em;">∞</span></span></span><span class="mjx-op"><span id="MJXc-Node-1062" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.749em; padding-bottom: 0.749em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.122em;"><span id="MJXc-Node-1063" class="mjx-texatom" style=""><span id="MJXc-Node-1064" class="mjx-mrow"><span id="MJXc-Node-1065" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">k</span></span><span id="MJXc-Node-1066" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.096em; padding-bottom: 0.329em;">=</span></span><span id="MJXc-Node-1067" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.376em; padding-bottom: 0.329em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-1069" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-1070" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">λ</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1071" class="mjx-texatom" style=""><span id="MJXc-Node-1072" class="mjx-mrow"><span id="MJXc-Node-1073" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">k</span></span><span id="MJXc-Node-1074" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.423em;">−</span></span><span id="MJXc-Node-1075" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.376em; padding-bottom: 0.329em;">1</span></span></span></span></span></span><span id="MJXc-Node-1076" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.12em;"><span id="MJXc-Node-1077" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.12em;">T</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.291em; padding-right: 0.071em;"><span id="MJXc-Node-1078" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">k</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>T</mi><mi>λ</mi></msub><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>λ</mi><mo stretchy="false">)</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi mathvariant="normal">∞</mi></munderover><msup><mi>λ</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>T</mi><mi>k</mi></msup></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-45">
    \begin{equation}
    T_\lambda = (1 - \lambda)\sum_{k=1}^\infty \lambda^{k-1} T^k
    \end{equation}
    </script></span></p>
    <p>where <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-46-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-1079" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1080" class="mjx-mrow"><span id="MJXc-Node-1081" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">(</span></span><span id="MJXc-Node-1082" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.376em; padding-bottom: 0.329em;">1</span></span><span id="MJXc-Node-1083" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.282em; padding-bottom: 0.423em;">−</span></span><span id="MJXc-Node-1084" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">λ</span></span><span id="MJXc-Node-1085" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.469em; padding-bottom: 0.609em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>λ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-46">(1 - \lambda)</script></span> is for the weights to sum up to one.</p>
    <h2 id="forward-and-backward-view">Forward and backward view</h2>
    <p>TD(<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-47-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-1086" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1087" class="mjx-mrow"><span id="MJXc-Node-1088" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">λ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>λ</mi></math></span></span><script type="math/tex" id="MathJax-Element-47">\lambda</script></span>) methods will solve for the fixed point of the <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-48-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-1089" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1090" class="mjx-mrow"><span id="MJXc-Node-1091" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.12em;"><span id="MJXc-Node-1092" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em; padding-right: 0.12em;">T</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-1093" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.469em; padding-bottom: 0.282em;">λ</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>λ</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-48">T_\lambda</script></span> operator. The interpretation of the lambda return is the <em>forward view</em> of eligibility traces. Since it is a statement about a quantity in the future, we will have to find a way to implement it in the present without having recourse to a magical time traveling machine to observe the future values. The mechanism to implement the forward view will take place with the <em>eligibility traces</em> in the <em>backward view</em>.</p>
    <p>More on this in the upcoming weeks.</p>
    </div>
    <script src="./Understanding eligibility traces in Reinforcement Learning_files/jquery.min.js.téléchargé"></script>
    <script src="./Understanding eligibility traces in Reinforcement Learning_files/bootstrap.min.js.téléchargé"></script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
       m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
         })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-68825837-1', 'auto');
    ga('send', 'pageview');

    </script>
  

</body></html>